{"ast":null,"code":"import _regeneratorRuntime from \"/Users/oche/Projects/Targetometer/Client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/oche/Projects/Targetometer/Client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/oche/Projects/Targetometer/Client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport createDataContext from \"./createDataContext\";\n\nvar authReducer = function authReducer(state, action) {\n  switch (action.type) {\n    case 'server_response':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        serverMessage: action.payload\n      });\n\n    case 'signup':\n      return {\n        serverMessage: ''\n      };\n\n    case 'signin':\n      return {\n        serverMessage: '',\n        token: action.payload\n      };\n\n    case 'confirmation':\n      return {\n        serverMessage: '',\n        response: action.payload\n      };\n\n    case 'signout':\n      return {\n        token: null,\n        serverMessage: ''\n      };\n\n    case 'clear_error_message':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        serverMessage: ''\n      });\n\n    default:\n      return state;\n  }\n};\n\nvar signup = function signup(dispatch) {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n      var password, firstname, lastname, email, confirmpassword, BASE_URL, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              password = _ref.password, firstname = _ref.firstname, lastname = _ref.lastname, email = _ref.email, confirmpassword = _ref.confirmpassword;\n              // make api request with email and passwords\n              BASE_URL = 'https://targetometer-server.herokuapp.com/api/v1/auth';\n              console.log('sign up button hit');\n              _context.prev = 3;\n              _context.next = 6;\n              return axios.post(\"\".concat(BASE_URL, \"/createaccount\"), _defineProperty({\n                firstname: firstname,\n                lastname: lastname,\n                email: email,\n                password: password\n              }, \"password\", password));\n\n            case 6:\n              response = _context.sent;\n              dispatch({\n                type: 'server_message',\n                payload: 'User Account has been created succesfully'\n              }); // const response = await trackerApi.post('/auth/createaccount', {phone, password, name})\n\n              _context.next = 13;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](3);\n              dispatch({\n                type: 'server_message',\n                payload: 'Something went wrong with signup'\n              });\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 10]]);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\n\nvar signin = function signin(dispatch) {\n  return /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref3) {\n      var email, password, response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              email = _ref3.email, password = _ref3.password;\n              _context2.prev = 1;\n              _context2.next = 4;\n              return trackerApi.post('/auth/login', {\n                phone: phone,\n                password: password\n              });\n\n            case 4:\n              response = _context2.sent;\n              _context2.next = 7;\n              return AsyncStorage.setItem('token', response.data.token);\n\n            case 7:\n              _context2.next = 9;\n              return AsyncStorage.setItem('username', response.data.user.username);\n\n            case 9:\n              dispatch({\n                type: 'signin',\n                payload: response.data.result\n              }); // console.log(response.data) \n              // let user = await AsyncStorage.getItem('user')\n              // console.log(response.data.token)\n\n              navigate('Home', {\n                Screen: \"HomeScreen\"\n              }); //    console.log('user succesfully logged in')\n              // console.log(`the token is ${jwttoken}`)\n\n              _context2.next = 16;\n              break;\n\n            case 13:\n              _context2.prev = 13;\n              _context2.t0 = _context2[\"catch\"](1);\n              // console.log(err)\n              dispatch({\n                type: 'server_message',\n                payload: _context2.t0.message\n              });\n\n            case 16:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 13]]);\n    }));\n\n    return function (_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n};\n\nvar tryLocalSignin = function tryLocalSignin(dispatch) {\n  return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    var token;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return AsyncStorage.getItem('token');\n\n          case 2:\n            token = _context3.sent;\n\n            if (token) {\n              dispatch({\n                type: 'signin',\n                payload: token\n              });\n              navigate('Home', {\n                Screen: \"HomeScreen\"\n              });\n            } else {\n              navigate('SignIn');\n            }\n\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n};\n\nvar confirmOtp = function confirmOtp(dispatch) {\n  return /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_ref6) {\n      var token, response;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              token = _ref6.token;\n              _context4.prev = 1;\n              _context4.next = 4;\n              return trackerApi.post('/auth/confirmphone', {\n                token: token\n              });\n\n            case 4:\n              response = _context4.sent;\n              dispatch({\n                type: 'confirmation',\n                payload: response.data\n              });\n              navigate('Confirmation');\n              _context4.next = 12;\n              break;\n\n            case 9:\n              _context4.prev = 9;\n              _context4.t0 = _context4[\"catch\"](1);\n              dispatch({\n                type: 'server_message',\n                payload: 'Something Went Wrong with Confirming code'\n              });\n\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 9]]);\n    }));\n\n    return function (_x3) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n};\n\nvar signout = function signout(dispatch) {\n  return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.next = 2;\n            return AsyncStorage.removeItem('token');\n\n          case 2:\n            dispatch({\n              type: 'signout'\n            }); // console.log('user has been logged out')\n\n            navigate('Authentication', {\n              screen: 'SignIn'\n            }); // handle error if sign out  fails\n\n          case 4:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n};\n\nvar clearServerMessage = function clearServerMessage(dispatch) {\n  return function () {\n    dispatch({\n      type: 'clear_server_message'\n    });\n  };\n};\n\nvar _createDataContext = createDataContext(authReducer, {\n  signin: signin,\n  signout: signout,\n  signup: signup,\n  confirmOtp: confirmOtp,\n  clearServerMessage: clearServerMessage,\n  tryLocalSignin: tryLocalSignin\n}, {\n  token: null,\n  serverMessage: '',\n  username: null\n}),\n    Provider = _createDataContext.Provider,\n    Context = _createDataContext.Context;\n\nexport { Provider, Context };","map":{"version":3,"sources":["/Users/oche/Projects/Targetometer/Client/context/AuthContext.js"],"names":["createDataContext","authReducer","state","action","type","serverMessage","payload","token","response","signup","dispatch","password","firstname","lastname","email","confirmpassword","BASE_URL","console","log","axios","post","signin","trackerApi","phone","AsyncStorage","setItem","data","user","username","result","navigate","Screen","message","tryLocalSignin","getItem","confirmOtp","signout","removeItem","screen","clearServerMessage","Provider","Context"],"mappings":"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","sourcesContent":["import createDataContext from \"./createDataContext\";\n\n\n\nconst authReducer = (state, action) =>{\n    switch (action.type){\n        case 'server_response':\n            return {...state, serverMessage: action.payload }\n        case 'signup':\n            return{serverMessage: ''}\n        case 'signin':\n            return{serverMessage: '', token: action.payload}\n        case 'confirmation':\n            return{serverMessage: '', response: action.payload}\n        case 'signout':\n            return{token: null, serverMessage: ''}\n        case 'clear_error_message':\n            return {...state, serverMessage: ''}\n        default:\n            return state\n    }\n}\n\nconst signup = (dispatch) => {\n    return async ({password, firstname, lastname, email, confirmpassword}) => {\n        // make api request with email and passwords\n        const BASE_URL = 'https://targetometer-server.herokuapp.com/api/v1/auth'\n       console.log('sign up button hit')\n        try{\n            const response = await axios.post(\n                `${BASE_URL}/createaccount`,\n                {\n                  firstname:firstname,\n                  lastname: lastname,\n                  email: email,\n                  password, password,\n                  \n                })\n            dispatch({\n                type: 'server_message',\n                payload: 'User Account has been created succesfully'\n            })\n            // const response = await trackerApi.post('/auth/createaccount', {phone, password, name})\n            \n           \n        }catch (err) {\n           \n            dispatch({\n                type: 'server_message', \n                payload: 'Something went wrong with signup'\n            })\n        }\n        // after signing up modify state\n\n        // handle error if signup fails\n    }\n    \n}\n\nconst signin = (dispatch) =>{\n    return async ({email, password}) => {\n        // make api request with phone and password\n        try{\n            // console.log('button fired')\n            const response = await trackerApi.post('/auth/login', {phone, password})\n            await AsyncStorage.setItem('token', response.data.token)\n            await AsyncStorage.setItem('username', response.data.user.username )\n            dispatch({type: 'signin', payload: response.data.result})\n            // console.log(response.data) \n            // let user = await AsyncStorage.getItem('user')\n            // console.log(response.data.token)\n            navigate('Home',{Screen:\"HomeScreen\"})\n            \n        //    console.log('user succesfully logged in')\n            \n            // console.log(`the token is ${jwttoken}`)\n        }catch(err){\n            // console.log(err)\n            dispatch({\n                type: 'server_message',\n                payload: err.message\n            })\n        }\n        // let user = await AsyncStorage.getItem('user')\n        // console.log(user)\n        // console.log('user succesfully logged in')\n        // after signing in modify state\n\n        // handle error if signin  fails\n    }\n}\n\n\nconst tryLocalSignin = dispatch => async() =>{\n    const token = await AsyncStorage.getItem('token')\n    if (token){\n        dispatch({type: 'signin', payload: token})\n        navigate('Home',{Screen:\"HomeScreen\"})\n    } else {\n        navigate('SignIn')\n    }\n}\n\nconst confirmOtp = (dispatch) => {\n    return async({token}) => {\n        // make api request with otp token\n        try{\n            const response = await trackerApi.post('/auth/confirmphone', {token})\n            dispatch({type: 'confirmation', payload: response.data})\n            navigate('Confirmation')\n        }catch(error){\n            dispatch({\n                type: 'server_message',\n                payload: 'Something Went Wrong with Confirming code'\n            })\n        }\n\n        // handle error if signin  fails\n    }\n}\n\n\nconst signout = (dispatch) =>{\n    return async() => {\n        // make api request with phone and password\n        await AsyncStorage.removeItem('token')\n        dispatch({type: 'signout'})\n        // console.log('user has been logged out')\n        navigate('Authentication', {screen: 'SignIn'})\n        // handle error if sign out  fails\n    }\n}\n\nconst clearServerMessage = dispatch => () => {\n    dispatch({type: 'clear_server_message'})\n}\n\nexport const {Provider, Context} = createDataContext(\n    authReducer,\n    { signin, signout, signup, confirmOtp, clearServerMessage, tryLocalSignin },\n    {token: null, serverMessage: '', username:null}\n)"]},"metadata":{},"sourceType":"module"}