{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport createDataContext from \"./createDataContext\";\n\nconst authReducer = (state, action) => {\n  switch (action.type) {\n    case 'server_response':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        serverMessage: action.payload\n      });\n\n    case 'signup':\n      return {\n        serverMessage: ''\n      };\n\n    case 'signin':\n      return {\n        serverMessage: '',\n        token: action.payload\n      };\n\n    case 'confirmation':\n      return {\n        serverMessage: '',\n        response: action.payload\n      };\n\n    case 'signout':\n      return {\n        token: null,\n        serverMessage: ''\n      };\n\n    case 'clear_error_message':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        serverMessage: ''\n      });\n\n    default:\n      return state;\n  }\n};\n\nconst signup = dispatch => {\n  return async ({\n    password,\n    firstname,\n    lastname,\n    email,\n    confirmpassword\n  }) => {\n    // make api request with email and password\n    console.log('sign up button hit');\n\n    try {\n      const response = await axios.post(`${BASE_URL}/createaccount`, {\n        firstname: firstname,\n        lastname: lastname,\n        email: email,\n        password,\n        password\n      });\n      dispatch({\n        type: 'server_message',\n        payload: 'User Account has been created succesfully'\n      }); // const response = await trackerApi.post('/auth/createaccount', {phone, password, name})\n    } catch (err) {\n      dispatch({\n        type: 'server_message',\n        payload: 'Something went wrong with signup'\n      });\n    } // after signing up modify state\n    // handle error if signup fails\n\n  };\n};\n\nconst signin = dispatch => {\n  return async ({\n    email,\n    password\n  }) => {\n    // make api request with phone and password\n    try {\n      // console.log('button fired')\n      const response = await trackerApi.post('/auth/login', {\n        phone,\n        password\n      });\n      await AsyncStorage.setItem('token', response.data.token);\n      await AsyncStorage.setItem('username', response.data.user.username);\n      dispatch({\n        type: 'signin',\n        payload: response.data.result\n      }); // console.log(response.data) \n      // let user = await AsyncStorage.getItem('user')\n      // console.log(response.data.token)\n\n      navigate('Home', {\n        Screen: \"HomeScreen\"\n      }); //    console.log('user succesfully logged in')\n      // console.log(`the token is ${jwttoken}`)\n    } catch (err) {\n      // console.log(err)\n      dispatch({\n        type: 'server_message',\n        payload: err.message\n      });\n    } // let user = await AsyncStorage.getItem('user')\n    // console.log(user)\n    // console.log('user succesfully logged in')\n    // after signing in modify state\n    // handle error if signin  fails\n\n  };\n};\n\nconst tryLocalSignin = dispatch => async () => {\n  const token = await AsyncStorage.getItem('token');\n\n  if (token) {\n    dispatch({\n      type: 'signin',\n      payload: token\n    });\n    navigate('Home', {\n      Screen: \"HomeScreen\"\n    });\n  } else {\n    navigate('SignIn');\n  }\n};\n\nconst confirmOtp = dispatch => {\n  return async ({\n    token\n  }) => {\n    // make api request with otp token\n    try {\n      const response = await trackerApi.post('/auth/confirmphone', {\n        token\n      });\n      dispatch({\n        type: 'confirmation',\n        payload: response.data\n      });\n      navigate('Confirmation');\n    } catch (error) {\n      dispatch({\n        type: 'server_message',\n        payload: 'Something Went Wrong with Confirming code'\n      });\n    } // handle error if signin  fails\n\n  };\n};\n\nconst signout = dispatch => {\n  return async () => {\n    // make api request with phone and password\n    await AsyncStorage.removeItem('token');\n    dispatch({\n      type: 'signout'\n    }); // console.log('user has been logged out')\n\n    navigate('Authentication', {\n      screen: 'SignIn'\n    }); // handle error if sign out  fails\n  };\n};\n\nconst clearServerMessage = dispatch => () => {\n  dispatch({\n    type: 'clear_server_message'\n  });\n};\n\nexport const {\n  Provider,\n  Context\n} = createDataContext(authReducer, {\n  signin,\n  signout,\n  signup,\n  confirmOtp,\n  clearServerMessage,\n  tryLocalSignin\n}, {\n  token: null,\n  serverMessage: '',\n  username: null\n});","map":{"version":3,"sources":["/Users/oche/Projects/Targetometer/Client/context/AuthContext.js"],"names":["createDataContext","authReducer","state","action","type","serverMessage","payload","token","response","signup","dispatch","password","firstname","lastname","email","confirmpassword","console","log","axios","post","BASE_URL","err","signin","trackerApi","phone","AsyncStorage","setItem","data","user","username","result","navigate","Screen","message","tryLocalSignin","getItem","confirmOtp","error","signout","removeItem","screen","clearServerMessage","Provider","Context"],"mappings":"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","sourcesContent":["import createDataContext from \"./createDataContext\";\n\n\n\nconst authReducer = (state, action) =>{\n    switch (action.type){\n        case 'server_response':\n            return {...state, serverMessage: action.payload }\n        case 'signup':\n            return{serverMessage: ''}\n        case 'signin':\n            return{serverMessage: '', token: action.payload}\n        case 'confirmation':\n            return{serverMessage: '', response: action.payload}\n        case 'signout':\n            return{token: null, serverMessage: ''}\n        case 'clear_error_message':\n            return {...state, serverMessage: ''}\n        default:\n            return state\n    }\n}\n\nconst signup = (dispatch) => {\n    return async ({password, firstname, lastname, email, confirmpassword}) => {\n        // make api request with email and password\n       console.log('sign up button hit')\n        try{\n            const response = await axios.post(\n                `${BASE_URL}/createaccount`,\n                {\n                  firstname:firstname,\n                  lastname: lastname,\n                  email: email,\n                  password, password,\n                  \n                })\n            dispatch({\n                type: 'server_message',\n                payload: 'User Account has been created succesfully'\n            })\n            // const response = await trackerApi.post('/auth/createaccount', {phone, password, name})\n            \n           \n        }catch (err) {\n           \n            dispatch({\n                type: 'server_message', \n                payload: 'Something went wrong with signup'\n            })\n        }\n        // after signing up modify state\n\n        // handle error if signup fails\n    }\n    \n}\n\nconst signin = (dispatch) =>{\n    return async ({email, password}) => {\n        // make api request with phone and password\n        try{\n            // console.log('button fired')\n            const response = await trackerApi.post('/auth/login', {phone, password})\n            await AsyncStorage.setItem('token', response.data.token)\n            await AsyncStorage.setItem('username', response.data.user.username )\n            dispatch({type: 'signin', payload: response.data.result})\n            // console.log(response.data) \n            // let user = await AsyncStorage.getItem('user')\n            // console.log(response.data.token)\n            navigate('Home',{Screen:\"HomeScreen\"})\n            \n        //    console.log('user succesfully logged in')\n            \n            // console.log(`the token is ${jwttoken}`)\n        }catch(err){\n            // console.log(err)\n            dispatch({\n                type: 'server_message',\n                payload: err.message\n            })\n        }\n        // let user = await AsyncStorage.getItem('user')\n        // console.log(user)\n        // console.log('user succesfully logged in')\n        // after signing in modify state\n\n        // handle error if signin  fails\n    }\n}\n\n\nconst tryLocalSignin = dispatch => async() =>{\n    const token = await AsyncStorage.getItem('token')\n    if (token){\n        dispatch({type: 'signin', payload: token})\n        navigate('Home',{Screen:\"HomeScreen\"})\n    } else {\n        navigate('SignIn')\n    }\n}\n\nconst confirmOtp = (dispatch) => {\n    return async({token}) => {\n        // make api request with otp token\n        try{\n            const response = await trackerApi.post('/auth/confirmphone', {token})\n            dispatch({type: 'confirmation', payload: response.data})\n            navigate('Confirmation')\n        }catch(error){\n            dispatch({\n                type: 'server_message',\n                payload: 'Something Went Wrong with Confirming code'\n            })\n        }\n\n        // handle error if signin  fails\n    }\n}\n\n\nconst signout = (dispatch) =>{\n    return async() => {\n        // make api request with phone and password\n        await AsyncStorage.removeItem('token')\n        dispatch({type: 'signout'})\n        // console.log('user has been logged out')\n        navigate('Authentication', {screen: 'SignIn'})\n        // handle error if sign out  fails\n    }\n}\n\nconst clearServerMessage = dispatch => () => {\n    dispatch({type: 'clear_server_message'})\n}\n\nexport const {Provider, Context} = createDataContext(\n    authReducer,\n    { signin, signout, signup, confirmOtp, clearServerMessage, tryLocalSignin },\n    {token: null, serverMessage: '', username:null}\n)"]},"metadata":{},"sourceType":"module"}